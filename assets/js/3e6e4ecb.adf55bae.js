"use strict";(self.webpackChunkgemblockchain_docs=self.webpackChunkgemblockchain_docs||[]).push([[549],{9457:function(e,t,n){n.r(t),n.d(t,{contentTitle:function(){return l},default:function(){return h},frontMatter:function(){return i},metadata:function(){return c},toc:function(){return u}});var a=n(7462),s=n(3366),r=(n(7294),n(3905)),o=["components"],i={sidebar_position:1},l="Substrate project structure",c={unversionedId:"substrate_project_structure",id:"substrate_project_structure",isDocsHomePage:!1,title:"Substrate project structure",description:"A Substrate project such as this consists of a number of components that are spread across a few",source:"@site/docs/substrate_project_structure.md",sourceDirName:".",slug:"/substrate_project_structure",permalink:"/docs/substrate_project_structure",editUrl:"https://github.com/gemblockchain/docs/edit/main/docs/substrate_project_structure.md",version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Node",permalink:"/docs/intro"}},u=[{value:"Node",id:"node",children:[]},{value:"Runtime",id:"runtime",children:[]},{value:"Pallets",id:"pallets",children:[]},{value:"Run in Docker",id:"run-in-docker",children:[]}],p={toc:u};function h(e){var t=e.components,n=(0,s.Z)(e,o);return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"substrate-project-structure"},"Substrate project structure"),(0,r.kt)("p",null,"A Substrate project such as this consists of a number of components that are spread across a few\ndirectories."),(0,r.kt)("h3",{id:"node"},"Node"),(0,r.kt)("p",null,"A blockchain node is an application that allows users to participate in a blockchain network.\nSubstrate-based blockchain nodes expose a number of capabilities:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Networking: Substrate nodes use the ",(0,r.kt)("a",{parentName:"li",href:"https://libp2p.io/"},(0,r.kt)("inlineCode",{parentName:"a"},"libp2p"))," networking stack to allow the\nnodes in the network to communicate with one another."),(0,r.kt)("li",{parentName:"ul"},"Consensus: Blockchains must have a way to come to\n",(0,r.kt)("a",{parentName:"li",href:"https://substrate.dev/docs/en/knowledgebase/advanced/consensus"},"consensus")," on the state of the\nnetwork. Substrate makes it possible to supply custom consensus engines and also ships with\nseveral consensus mechanisms that have been built on top of\n",(0,r.kt)("a",{parentName:"li",href:"https://research.web3.foundation/en/latest/polkadot/NPoS/index.html"},"Web3 Foundation research"),"."),(0,r.kt)("li",{parentName:"ul"},"RPC Server: A remote procedure call (RPC) server is used to interact with Substrate nodes.")),(0,r.kt)("p",null,"There are several files in the ",(0,r.kt)("inlineCode",{parentName:"p"},"node")," directory - take special note of the following:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/gemblockchain/gem/blob/main/node/src/chain_spec.rs"},(0,r.kt)("inlineCode",{parentName:"a"},"chain_spec.rs")),": A\n",(0,r.kt)("a",{parentName:"li",href:"https://substrate.dev/docs/en/knowledgebase/integrate/chain-spec"},"chain specification")," is a\nsource code file that defines a Substrate chain's initial (genesis) state. Chain specifications\nare useful for development and testing, and critical when architecting the launch of a\nproduction chain. Take note of the ",(0,r.kt)("inlineCode",{parentName:"li"},"development_config")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"testnet_genesis")," functions, which\nare used to define the genesis state for the local development chain configuration. These\nfunctions identify some\n",(0,r.kt)("a",{parentName:"li",href:"https://substrate.dev/docs/en/knowledgebase/integrate/subkey#well-known-keys"},"well-known accounts"),"\nand use them to configure the blockchain's initial state."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/gemblockchain/gem/blob/main/node/src/service.rs"},(0,r.kt)("inlineCode",{parentName:"a"},"service.rs")),": This file defines the node implementation. Take note of\nthe libraries that this file imports and the names of the functions it invokes. In particular,\nthere are references to consensus-related topics, such as the\n",(0,r.kt)("a",{parentName:"li",href:"https://substrate.dev/docs/en/knowledgebase/advanced/consensus#longest-chain-rule"},"longest chain rule"),",\nthe ",(0,r.kt)("a",{parentName:"li",href:"https://substrate.dev/docs/en/knowledgebase/advanced/consensus#aura"},"Aura")," block authoring\nmechanism and the\n",(0,r.kt)("a",{parentName:"li",href:"https://substrate.dev/docs/en/knowledgebase/advanced/consensus#grandpa"},"GRANDPA")," finality\ngadget.")),(0,r.kt)("p",null,"After the node has been ",(0,r.kt)("a",{parentName:"p",href:"#build"},"built"),", refer to the embedded documentation to learn more about the\ncapabilities and configuration parameters that it exposes:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"./target/release/gem --help\n")),(0,r.kt)("h3",{id:"runtime"},"Runtime"),(0,r.kt)("p",null,'In Substrate, the terms\n"',(0,r.kt)("a",{parentName:"p",href:"https://substrate.dev/docs/en/knowledgebase/getting-started/glossary#runtime"},"runtime"),'" and\n"',(0,r.kt)("a",{parentName:"p",href:"https://substrate.dev/docs/en/knowledgebase/getting-started/glossary#stf-state-transition-function"},"state transition function"),'"\nare analogous - they refer to the core logic of the blockchain that is responsible for validating\nblocks and executing the state changes they define. The Substrate project in this repository uses\nthe ',(0,r.kt)("a",{parentName:"p",href:"https://substrate.dev/docs/en/knowledgebase/runtime/frame"},"FRAME"),' framework to construct a\nblockchain runtime. FRAME allows runtime developers to declare domain-specific logic in modules\ncalled "pallets". At the heart of FRAME is a helpful\n',(0,r.kt)("a",{parentName:"p",href:"https://substrate.dev/docs/en/knowledgebase/runtime/macros"},"macro language")," that makes it easy to\ncreate pallets and flexibly compose them to create blockchains that can address\n",(0,r.kt)("a",{parentName:"p",href:"https://www.substrate.io/substrate-users/"},"a variety of needs"),"."),(0,r.kt)("p",null,"Review the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/gemblockchain/gem/blob/main/runtime/src/lib.rs"},"FRAME runtime implementation")," included in this Gem node and note\nthe following:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"This file configures several pallets to include in the runtime. Each pallet configuration is\ndefined by a code block that begins with ",(0,r.kt)("inlineCode",{parentName:"li"},"impl $PALLET_NAME::Config for Runtime"),"."),(0,r.kt)("li",{parentName:"ul"},"The pallets are composed into a single runtime by way of the\n",(0,r.kt)("a",{parentName:"li",href:"https://crates.parity.io/frame_support/macro.construct_runtime.html"},(0,r.kt)("inlineCode",{parentName:"a"},"construct_runtime!")),"\nmacro, which is part of the core\n",(0,r.kt)("a",{parentName:"li",href:"https://substrate.dev/docs/en/knowledgebase/runtime/frame#support-library"},"FRAME Support"),"\nlibrary.")),(0,r.kt)("h3",{id:"pallets"},"Pallets"),(0,r.kt)("p",null,"The runtime in this project is constructed using many FRAME pallets that ship with the\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/paritytech/substrate/tree/master/frame"},"core Substrate repository")," and a\ntemplate pallet that is ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/gemblockchain/gem/blob/main/pallets/template/src/lib.rs"},"defined in the ",(0,r.kt)("inlineCode",{parentName:"a"},"pallets"))," directory."),(0,r.kt)("p",null,"A FRAME pallet is compromised of a number of blockchain primitives:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Storage: FRAME defines a rich set of powerful\n",(0,r.kt)("a",{parentName:"li",href:"https://substrate.dev/docs/en/knowledgebase/runtime/storage"},"storage abstractions")," that makes\nit easy to use Substrate's efficient key-value database to manage the evolving state of a\nblockchain."),(0,r.kt)("li",{parentName:"ul"},"Dispatchables: FRAME pallets define special types of functions that can be invoked (dispatched)\nfrom outside of the runtime in order to update its state."),(0,r.kt)("li",{parentName:"ul"},"Events: Substrate uses ",(0,r.kt)("a",{parentName:"li",href:"https://substrate.dev/docs/en/knowledgebase/runtime/events"},"events")," to\nnotify users of important changes in the runtime."),(0,r.kt)("li",{parentName:"ul"},"Errors: When a dispatchable fails, it returns an error."),(0,r.kt)("li",{parentName:"ul"},"Config: The ",(0,r.kt)("inlineCode",{parentName:"li"},"Config")," configuration interface is used to define the types and parameters upon\nwhich a FRAME pallet depends.")),(0,r.kt)("h3",{id:"run-in-docker"},"Run in Docker"),(0,r.kt)("p",null,"First, install ",(0,r.kt)("a",{parentName:"p",href:"https://docs.docker.com/get-docker/"},"Docker")," and\n",(0,r.kt)("a",{parentName:"p",href:"https://docs.docker.com/compose/install/"},"Docker Compose"),"."),(0,r.kt)("p",null,"Then run the following command to start a single node development chain."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"./scripts/docker_run.sh\n")),(0,r.kt)("p",null,"This command will firstly compile your code, and then start a local development network. You can\nalso replace the default command (",(0,r.kt)("inlineCode",{parentName:"p"},"cargo build --release && ./target/release/gem --dev --ws-external"),")\nby appending your own. A few useful ones are as follow."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# Run Substrate node without re-compiling\n./scripts/docker_run.sh ./target/release/gem --dev --ws-external\n\n# Purge the local dev chain\n./scripts/docker_run.sh ./target/release/gem purge-chain --dev\n\n# Check whether the code is compilable\n./scripts/docker_run.sh cargo check\n")))}h.isMDXComponent=!0}}]);